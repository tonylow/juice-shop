"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var path = require("path");
var url = require("url");
exports.TEST_HOOKS_FILE_NAME = require.resolve('./testHooksForStryker');
var TestHooksMiddleware = /** @class */ (function () {
    function TestHooksMiddleware() {
        var _this = this;
        this.currentTestHooks = '';
        this.handler = function (request, response, next) {
            var pathName = url.parse(request.url).pathname;
            if (pathName && path.normalize(pathName).endsWith(path.join('src', path.basename(exports.TEST_HOOKS_FILE_NAME)))) {
                response.writeHead(200, {
                    'Content-Type': 'application/javascript',
                    'Cache-Control': 'no-cache'
                });
                response.end(_this.currentTestHooks);
            }
            else {
                next();
            }
        };
        // This `.bind` call is important! The `handler` will be executed with `.apply` (or friends) and otherwise the `this` won't point to this instance!
        this.handler = this.handler.bind(this);
    }
    Object.defineProperty(TestHooksMiddleware, "instance", {
        get: function () {
            if (!this._instance) {
                this._instance = new TestHooksMiddleware();
            }
            return this._instance;
        },
        enumerable: true,
        configurable: true
    });
    return TestHooksMiddleware;
}());
exports.default = TestHooksMiddleware;
//# sourceMappingURL=TestHooksMiddleware.js.map